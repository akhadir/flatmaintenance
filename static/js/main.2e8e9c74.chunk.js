(this["webpackJsonpflat-maintenance"]=this["webpackJsonpflat-maintenance"]||[]).push([[0],{213:function(e,t){},378:function(e,t){},477:function(e,t){},479:function(e,t){},503:function(e,t){},531:function(e,t){},533:function(e,t){},562:function(e,t){},564:function(e,t){},565:function(e,t){},571:function(e,t){},573:function(e,t){},576:function(e,t){},578:function(e,t){},598:function(e,t){},614:function(e,t){},617:function(e,t){},664:function(e,t){},691:function(e,t,a){},744:function(e,t,a){},745:function(e,t,a){},749:function(e,t,a){},750:function(e,t,a){},751:function(e,t,a){},760:function(e,t,a){},762:function(e,t){},763:function(e,t){},764:function(e,t,a){},765:function(e,t,a){},766:function(e,t,a){},767:function(e,t,a){},768:function(e,t,a){},769:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(381),s=a(106),o=a(859),c=a(52),l=a(428),d=a.n(l),p=a(429),h=a.n(p),u=a(425),g=a.n(u),j=a(424),b=a.n(j),O=a(427),m=a.n(O),v=a(426),S=a.n(v),A=a(107),y=a(125),C=a(385);let f=function(e){return e.LOAD_TRANS="LOAD_TRANS",e.LOAD_CASH_TRANS_SUCCESS="LOAD_CASH_TRANS_SUCCESS",e.LOAD_ONLINE_TRANS_SUCCESS="LOAD_ONLINE_TRANS_SUCCESS",e.LOAD_CASH_TRANS_FAILURE="LOAD_CASH_TRANS_FAILURE",e.LOAD_ONLINE_TRANS_FAILURE="LOAD_ONLINE_TRANS_FAILURE",e.UPDATE_MONTHLY_SPLIT="UPDATE_MONTHLY_SPLIT",e.RESET_MONTHLY_SPLIT="RESET_MONTHLY_SPLIT",e.UPDATE_MONTHLY_MAINT_SPLIT="UPDATE_MONTHLY_MAINT_SPLIT",e.RESET_MONTHLY_MAINT_SPLIT="RESET_MONTHLY_MAINT_SPLIT",e.RESET_TRANS="RESET_TRANS",e}({});const x={loading:!1,cashTransData:void 0,onlineTransData:void 0,monthlyCatSplit:void 0,error:""};var D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.LOAD_TRANS:return{...e,loading:!0};case f.LOAD_CASH_TRANS_SUCCESS:return{...e,loading:!1,cashTransData:t.payload,error:""};case f.LOAD_ONLINE_TRANS_SUCCESS:return{...e,loading:!1,onlineTransData:t.payload,error:""};case f.LOAD_CASH_TRANS_FAILURE:return{...e,loading:!1,cashTransData:void 0,error:t.payload};case f.LOAD_ONLINE_TRANS_FAILURE:return{...e,loading:!1,onlineTransData:void 0,error:t.payload};case f.UPDATE_MONTHLY_SPLIT:return{...e,monthlyCatSplit:t.payload,loading:!1};case f.RESET_MONTHLY_SPLIT:return{...e,monthlyCatSplit:void 0};case f.UPDATE_MONTHLY_MAINT_SPLIT:return{...e,monthlyMaintSplit:t.payload,loading:!1};case f.RESET_MONTHLY_MAINT_SPLIT:return{...e,monthlyMaintSplit:void 0};case f.RESET_TRANS:return x;default:return e}},T=a(384),E=a(47),I=a.n(E),N=a(30),M=a.n(N);const R=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t={res:!1,error:""};if(e){const n=I.a.AES.decrypt(L.ENC_CLIENT_EMAIL,e),i=I.a.AES.decrypt(L.ENC_PRIVATE_KEY,e),r=I.a.AES.decrypt(L.ENC_CHAT_GPT_KEY,e),s=I.a.AES.decrypt(L.ENC_GOOGLE_API_KEY,e),o=I.a.AES.decrypt(L.ENC_GEMINI_KEY,e),c=I.a.AES.decrypt(L.OCR_SPACE_KEY,e);try{L.clientEmail=n.toString(I.a.enc.Utf8),L.privateKey=i.toString(I.a.enc.Utf8),L.googleAPIKey=s.toString(I.a.enc.Utf8),L.secret=e,L.chatGPTPrivateKey=r.toString(I.a.enc.Utf8),L.geminiKey=o.toString(I.a.enc.Utf8),L.ocrSpaceKey=c.toString(I.a.enc.Utf8),sessionStorage.setItem("session-id",e),t.res=!0}catch(a){L.secret="",t.res=!1,t.error="Invalid Secret Provided"}}else L.secret="",t.res=!1,t.error="Empty Secret Set";return t},w=["001","002","003","004","005","007","008","009","010","011","012","101","102","103","104","105","106","107","108","109","110","111","112","201","202","203","204","205","206","207","208","209","210","211","212","301","302","303","304","305","306","307","308","309","310","311","312","401","402","403","404","405","406","407","408","409","410","411","412"],k={transCategories:[{key:"maintenance",label:"Maintenance",children:w.map((e=>({key:`maintenance-${e}`,label:e})))},{key:"corpus",label:"Corpus Fund",children:w.map((e=>({key:`corpus-${e}`,label:e})))},{key:"monthly",label:"Monthly Expenses",children:[]},{key:"others",label:"Others",children:[{key:"fine",label:"Fine"},{key:"extra",label:"Other Income"},{key:"account-transfer",label:"FD Deposit"},{key:"tenant-deposit",label:"Tenant Deposit"},{key:"rd-deposit",label:"Deposit to RD account"}]}],transactionFinYear:M()().format("YY"),transSheetMonth:"",transactions:[]},Y="1aumDbLSTH31n1MFpguM0-THWslbR3ZPNCXSlI72WuBo",L={secret:sessionStorage.getItem("session-id")||"",SPREADSHEET_ID:Y,ENC_CLIENT_EMAIL:"U2FsdGVkX19lrOkAqkI1YRZkdHSjXZc+dtJNUzOhSlqaydB6Gxi4lm9MpS7+2/W7OtInfOCmh739buu1z1jzT/jJrAeRX2+hKkxc+3qsduw=",ENC_PRIVATE_KEY:"U2FsdGVkX1/i7T93uNMkvtV/hIYkButYpbgdWdXVf4ftrMUIjGc7OmaZRamJzAZNh3HKcvAW92t+mtWkIpJ2sLzLlB0BWWbBTZDPl+C/oD1YCcDZYCCPaHOcSvedvzBXLP3lGDi61mXPqPPGMDquh90g7oKvO8w+Oe6JIV8HQ9EYYB/rd/IRj34CP9K96NQDxcy06xsL2SfMMQuqSyBwRYYebogb4NZgpjfSKx6AJCvRnHkZMGBt2E0xtGm1UmS+XLq1Dlay8s2fJAYuF4yxSMjJpCzhOdTY0rhbTIQ8D3kZvJJU9+MCS4yqsVBCdqkWRqoQBBhHk8vSwb8ZTcomRUg4w6JDOu+HCT4vA6x5Jz8aSYu0CxZKndd4gHXy55YklnC728IKDavaEC13bNG/OrsBQL8P0IjzuomEAiQdFpdoQg81JmANZx1MbGD8NvdmuNEGzkTLPEssID5pO1AzGCepSeikWB8XXkJu+kHLGQe6SyBE7oxv5SDfeexWfkGOObo2Af9VbtZwg+jlVgKzf0lBj9NW0soC15VrpzV4t7oUpMT3Fe6d3oijHQ2hPxTYZMfuA8UsyO3WSTUbaxNWOpUbijJsDSUpENGQyr1XFSV4+3aN78prPt443BiaHAm8i50y9z2P7TJJteRrRE900MBm/9sMRK3fZb91VUJ9wsvmzRsJK7cxxBStx7T1k3wxQZCJisWXej+vqRlP0le95yB/2BikMV+nYyom4gQrySk8eW2rzvx26LS3LHf867SdpXSWzT7RBdIhxd6IXsK8B/fIjmR6zpeqMb/LUjRm4LcTn3UZgKEYDEFmgRGR07lsTP1czidqjCuOn+o9mZblzbsMFFAFzPhaj0ZKcO82vs3bHkDGIfoaN+EimD1ThwxlEehX08EOOKNLp19sxpUcwaxjbRgwunMh0o7J/H92TpsppRJJRfUEsI/ReI021yqkpiqRZcI/cEn3NykY1MualaqkuddoKqeD2LKjOmxaT26niNSsd/ffhjBD5f1DCWq84iXQaje6SIV1ZwesIUbUUG7MSTHI6Mf3LZuWIK/HQU/MhSYYtIHv7rvcJUyw0e/ZnUfKBRgyMYSLeTZI55MYPJ0HUGPJWIWnYMk8ESLBLnPnDknXo2m1i87Y37ui3Snqy7s6WW6nYlz1/HPexx/HQaQl5UsRGNre6+RREonqmL+B+AITWlN+bA4iLOnYfCg8OdyACDWBge3fwxduWWB4vtzlDNMx/Xqcb52BZAAh6d6Z7AE3t66ZfHv16VZnEEm14uV+zBgt41Mkfv0LNFZ6cqOjafwioFnMO9e3j738n2xwKMzcMzsdnhmHkyF7i7PLZqbTBp8P167/psPnfUV8vfcsmTombUUzOzViqJABfG6EczwhN19dd4lusGVDNrz43ywTA5zfU/jMcy1wk7i90rXo0HZSNNOuLGog2+qlx2xuyHORqdEVshb0BeJYckX95zjXLu6BuTO66vp4oIzecv9vprH3Jfx67mRvKKa+8xExXlY0BDM7vND5+EAZ0wz71MJonVjx/cXHqrSDxcnU1x5BJLAgZliQDZk/lAxBbUSuqvF21NBvZWGk2rDRKr5rTibBRDeOGoTQW1kRus87/YPBvThJ2OlFHkEAYskLyk8xPFTeC2XUJCEF7K6U3UpjL7LLWoCP+KcwazlItikvTzR44AAf2iFRf0+6wVQLZjpHZed0Z7KchTDyCm0ydVHuMAJjpogPjUbj26tbiICQ9SRtO+keG+JUHElkQzOe0bfsTuw8CqwPm6C1hNL9ReYYxrbwAwrZU8si4RWE1qSJ3cQXrxIOP275Uvsr5eUlgWYdJBrrYGUOjvQupB5CX9JL9SuH8Rfml2NzrMLWMM5mT9R1amUKLcl2ZyLkC4NDEmeqxPMtRtPLlQA/1aH939OdMbR5OZ9ozlSZFGiSS1eucvK44xvI4KCbFARx+urxXQgTSmZd/GwcFc5ZZXlojU8DTgQc5HTijP2x8iMptYYK/iPz2brWPs7LZsOiBaKCsbzWGdu/Lo3xJRqZoS5x7jGNl2q0JCj9/a0m7v+ODEZ6LaAQwsKX6M5iqNQ0YQWzlMClB6i1shbbrLsqtACXovqx9ACssZMVt7U9/WlDnmpjV+QT5Duhx8WBKehO2CeL2W9ZO8TtW+YDsV0mytvkXPwMl2RwMSAoNVau7b4CrU67z8BEVFcRKGHIURXxN/vithCvLR7Kk8+37cF16NOLBu1t6uixXH+0371xj74wJf7RFeeceyeZvGDrAsJ5qRvqD+vsAjl3EGUJySw1BJryedcR",ENC_GOOGLE_API_KEY:"U2FsdGVkX1+z10t9/VGkdh+xgB9JO7TwDIGpiW5ivAoQrmKV9c77947cJH49fTgzZcc5DSaLNH1jlCpIiLbSuw==",ENC_CHAT_GPT_KEY:"U2FsdGVkX19CE/c8Tng+qxPTykma92uBwnVA8hVNUPhl5desREv8awMfLxjN2ZnKC23rEB6XcYTSzVfgEwgEqQPZuhXq3Ef0cng56m8DqyI=",ENC_GEMINI_KEY:"U2FsdGVkX1+ja6BvyIZ4xRS/wHKtCFsD22qQ0wfw/U30gL6c2FfqhrQyqt25ch1C77vdq1A7rlLZ0RKBXXjmaQ==",OCR_SPACE_KEY:"U2FsdGVkX1/Je2pGMUWIY8Mnid+Xulw55FuCkiYcNvU=",doc:new T.GoogleSpreadsheet(Y),appData:k},B=()=>L;L.secret&&R(L.secret);const P=i.a.createContext(L);var _=P,U=function(e){return e.INIT="INIT",e.INIT_SUCCESS="GET_SHEET_INFO",e.INIT_FAILURE="GET_SHEET_INFO_FAILURE",e.SET_SHEET_INFO="SET_SHEET_INFO",e}(U||{}),H=U;const F={initError:"",sheetConfig:B(),sheetInfo:new Map};var K=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H.INIT:return{...e,initializing:!0};case H.INIT_SUCCESS:return{...e,initializing:!1,appConfig:t.payload};case H.INIT_FAILURE:return{...e,initializing:!1,initError:t.payload};case H.SET_SHEET_INFO:return{...e,sheetInfo:t.payload};default:return e}};let J=function(e){return e.INIT="INIT",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE",e.SET_CONFIG="SET_CONFIG",e.ADD_EVENTS="ADD_EVENTS",e}({});const W={isLoading:!1,data:{},config:{encBotId:"U2FsdGVkX1/0gDV/ibea6VfAgozs8tNyWPB0zt3iRLDsNORNjxOhmloQXZl7ywLjxeQl4Bmxe3iZ7RLdUxi+BA==",listURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/get.php",fetchURL:"https://api.telegram.org/bot{{botId}}/getFile?file_id={{fileId}}",downloadURL:"https://api.telegram.org/file/bot{{botId}}/photos/{{filePath}}",updateURL:"https://state-tourniquet.000webhostapp.com/suraksha/telegram/processed.php?id={{recordId}}"},layoutData:void 0,events:[]};var q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.INIT:return{...e,isLoading:!0,layoutData:t.payload};case J.SUCCESS:return{...e,isLoading:!1,data:t.payload,error:void 0};case J.FAILURE:return{...e,isLoading:!1,data:void 0,error:t.payload};case J.SET_CONFIG:return{...e,config:t.payload};case J.ADD_EVENTS:return{...e,events:[...e.events,t.payload]};default:return e}};var V=Object(y.b)({sheet:K,trans:D,bills:q});const G=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||y.c;var z=Object(y.d)(V,G(Object(y.a)(C.a))),Z=a(846),X=a(851),$=a(873),Q=a(874),ee=a(875),te=a(876),ae=a(864),ne=a(1);function ie(e){const[t,a]=i.a.useState(!0),[r,s]=i.a.useState(""),o=Object(n.useCallback)((()=>{e.handleSecret(r)}),[e,r]),c=Object(n.useCallback)((e=>{s(e.target.value)}),[]),l=Object(n.useCallback)((t=>{13===(t.keyCode?t.keyCode:t.which)&&e.handleSecret(r)}),[e,r]);return Object(ne.jsxs)(Z.a,{open:t,keepMounted:!0,"aria-labelledby":"Secret Key","aria-describedby":"Enter your secret key",children:[Object(ne.jsx)(X.a,{id:"alert-dialog-slide-title",children:"Enter the secret key!!!"}),Object(ne.jsxs)($.a,{children:[Object(ne.jsx)(Q.a,{id:"alert-dialog-slide-description",children:"Check with other committee members, if secret key is not known."}),Object(ne.jsx)(ee.a,{type:"password",value:r,onChange:c,onKeyPress:l}),Object(ne.jsx)("div",{className:"error",children:e.errorMsg})]}),Object(ne.jsx)(te.a,{children:Object(ne.jsx)(ae.a,{onClick:o,disabled:!r,color:"primary",children:"OK"})})]})}var re=a(16),se=a(877),oe=a(398),ce=a.n(oe),le=a(397),de=a.n(le),pe=(a(691),a(50)),he=a.n(pe),ue=a(393),ge=a(395),je=a.n(ge),be=a(396);const Oe=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.floor(Date.now()/1e3+3600);const{clientEmail:t,privateKey:a}=B(),n={iss:t,sub:"",aud:"https://www.googleapis.com/oauth2/v4/token",scope:"https://www.googleapis.com/auth/drive",exp:e,iat:Math.floor(Date.now()/1e3),jti:Object(be.uuid)()};return je.a.sign(n,a||"",{algorithm:"RS256"})},me=async()=>{const{clientEmail:e}=B(),t={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",client_id:e,assertion:await Oe()},a=await he.a.post("https://www.googleapis.com/oauth2/v4/token",t);if(200===a.status)return a.data.access_token;throw new Error(a.data)};const ve="VERIFIED_",Se="1-6owJyxGQSwRKxcJyMI3NXY4v-APeBui";async function Ae(e){const{googleAPIKey:t}=B(),a=encodeURI(`'${e||Se}' in parents and (mimeType = 'image/jpeg' or mimeType = 'image/png' or mimeType = 'application/pdf' or mimeType = 'application/vnd.google-apps.folder')`);try{const e=await he.a.get(`https://www.googleapis.com/drive/v3/files?q=${a}&key=${t}`),{files:n}=e.data;return console.log("Fetched files:",n),n}catch(n){console.error("Error fetching files:",(null===n||void 0===n?void 0:n.message)||n)}return[]}const ye=async(e,t)=>{try{const a=await me(),n=await he.a.patch(`https://www.googleapis.com/drive/v3/files/${e}`,{name:`${ve}${t}`},{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(console.log("File moved successfully:",n.data),200===n.status)return n.data}catch(a){console.error("Error occurred while moving the file:",a)}return null};const Ce=()=>B().ocrSpaceKey||"",fe="https://api.ocr.space/parse/image";const xe=async e=>{const t=function(e){let t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);const a=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length);for(let i=0;i<t.length;i+=1)n[i]=t.charCodeAt(i);return new Blob([n],{type:a})}(e),a=new File([t],"canvasImage.jpg",{type:"image/jpeg"}),n=new FormData;n.append("base64Image",a);return await he.a.post(fe,n,{headers:{"Content-Type":"multipart/form-data",apikey:Ce()}})};var De=a(228);class Te{constructor(){if(this.chatGPTPrivateKey="",this.openAI=void 0,this.appConfig=void 0,this.appConfig=B(),this.appConfig.chatGPTPrivateKey){this.chatGPTPrivateKey=this.appConfig.chatGPTPrivateKey;const e=new De.Configuration({organization:"org-wfOq673LgvxydlfXwY3Fmcvm",apiKey:this.chatGPTPrivateKey});this.openAI=new De.OpenAIApi(e)}}async getCompleted(e){return this.openAI?this.openAI.createCompletion({model:"text-davinci-003",prompt:"Say this is a test",max_tokens:7,temperature:0,top_p:1,n:1,stream:!1,logprobs:null,stop:"\n"}):Promise.resolve("")}static getInstance(){return Te.instance||(Te.instance=new Te),Te.instance}}Te.instance=void 0;var Ee=Te;var Ie=function(){const e=Object(n.useRef)(),[t,a]=Object(n.useState)(),[i,r]=Object(n.useState)(!0),s=Object(n.useCallback)((()=>{const n=e.current||{};!t&&n&&n.takePhoto?(a(n.takePhoto()),r(!1)):a(void 0)}),[e,t]),o=Object(n.useCallback)((()=>{r((e=>!e))}),[]),c=i?"cash-trans block-page":"cash-trans",[l,d]=Object(n.useState)();return Object(n.useEffect)((()=>{t&&xe(t).then((async e=>{const{ParsedText:t}=e.data.ParsedResults[0]||{};if(t){const e=await Ee.getInstance().getCompleted(t);d(e)}}))}),[t]),Object(ne.jsxs)("div",{className:c,children:[Object(ne.jsx)("div",{children:"Handle Cash Transactions"}),Object(ne.jsx)("pre",{children:JSON.stringify(l,void 0,4)}),!t&&Object(ne.jsx)(se.a,{className:"close-camera","aria-label":"Take Photo",onClick:o,children:i?Object(ne.jsx)(de.a,{}):Object(ne.jsx)(ce.a,{})}),Object(ne.jsx)(se.a,{className:"camera-click","aria-label":"Take Photo",onClick:s,children:Object(ne.jsx)("img",{src:"/images/circular-camera.png",alt:"Take Pic"})})]})};var Ne=()=>Object(ne.jsx)(Ie,{}),Me=a(141),Re=a(865),we=a(783),ke=a(884),Ye=a(860);var Le={"Audit Fees":1,BWSSB:2,Diesel:3,Bescom:4,"House Keeping Salary":5,Security:6,"Garden Maintenance":7,"Garbage Collection Vendor / BBMP":8,"Borewell And Motor Maintenance":9,"Annual Bonus":10,"Lift Maintenance":11,"HK Items Purchased":12,"Health Club Maintenance":13,"Electrical / Plumbing Repairs":14,"Apartment repairs related":15,"Apartment Safety":16,"CCTV / Intercomm":17,"Misc expenses":18,"Apartment developments":19,"Apartment Work By Security and Others":20,"Septic Tank Repairs / Cleaning":21,"Water Tanks Cleaning":22,"Generator Maintenance and Repair":23,"Savings Bank SMS Charges/Cheque book":24,"Festival/Holiday Celebration":25,"Drinking Water for Employees":26,"BAF Subscription Charges":27,"Maintenance Collection":30,"Income Tax Refund":31,"Other Income":32,"Interest on account":33,"Fine / Extra Payment Received":34,"Corpus Fund":35,"Tenant Deposit from the Owners":36,"FD Deposit":37,"Deposit to RD account":38};var Be={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13},Pe={"001":1,"002":2,"003":3,"004":4,"005":5,"007":6,"008":7,"009":8,"010":9,"011":10,"012":11,101:12,102:13,103:14,104:15,105:16,106:17,107:18,108:19,109:20,110:21,111:22,112:23,201:24,202:25,203:26,204:27,205:28,206:29,207:30,208:31,209:32,210:33,211:34,212:35,301:36,302:37,303:38,304:39,305:40,306:41,307:42,308:43,309:44,310:45,311:46,312:47,401:48,402:49,403:50,404:51,405:52,406:53,407:54,408:55,409:56,410:57,411:58,412:59};var _e={Apr:2,May:3,Jun:4,Jul:5,Aug:6,Sep:7,Oct:8,Nov:9,Dec:10,Jan:11,Feb:12,Mar:13};let Ue;class He{constructor(){this.currentSheet="",this.initialized=!1,this.appConfig=void 0,this.appConfig=B()}init(){return this.initialized?Promise.resolve(this.appConfig.doc):new Promise(((e,t)=>{const{doc:a}=this.appConfig;a.useServiceAccountAuth({client_email:this.appConfig.clientEmail||"",private_key:this.appConfig.privateKey||""}).then((()=>{a.loadInfo().then((()=>{this.initialized=!0,e(a)})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e),t(e)}))}))}getSpreadSheet(){return this.appConfig.doc}async getSheetByTitleAsJson(e){const t=[],a=await this.getSheetByTitle(e);let n=a.headerValues,i=a.columnCount;if(!n||0===n.length){n=[];for(let e=0;e<i;e+=1){const{value:t}=a.getCell(0,e);t&&n.push(a.getCell(0,e).value.toString())}}i=n.length;const{rowCount:r}=a;for(let s=1;s<r;s+=1){const e={},r=[];for(let t=0;t<i;t+=1){const i=n[t],o=a.getCell(s,t).formattedValue;e[i]=o,r.push(o)}if(!r.some((e=>null!==e)))break;t.push(e)}return t}async getSheetByTitle(e){var t;const a=null===(t=this.appConfig.doc)||void 0===t?void 0:t.sheetsByTitle[e];return a&&(this.currentSheet=a.sheetId,await a.loadCells()),a}async getSheet(e){this.currentSheet=e;const t=this.appConfig.doc.sheetsById[e];return await t.loadCells(),t}appendSheet(e,t){return this.appConfig.doc.sheetsById[e].addRow(t)}append(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].addRow(e)}async appendRows(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""];await t.addRows(e)}getSheetRow(e,t){return this.appConfig.doc.sheetsById[e].getRows({limit:1,offset:t})}getRow(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].getRows({limit:1,offset:e})}getColumn(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""],a=[],n=t.rowCount<100?t.rowCount:100;for(let i=0;i<n-1;i+=1)a.push(t.getCell(i,e));return a}getColumnWithSheet(e,t){const a=[],n=e.rowCount<100?e.rowCount:100;for(let i=0;i<n-1;i+=1)a.push(e.getCell(i,t));return a}getSheetColumn(e,t){const a=this.appConfig.doc.sheetsById[e],n=[],i=a.rowCount<100?a.rowCount:100;for(let r=0;r<i-1;r+=1)n.push(a.getCell(r,t));return n}getSheetCell(e,t,a){return this.appConfig.doc.sheetsById[e].getCell(t,a)}getCell(e,t){return this.appConfig.doc.sheetsById[this.currentSheet||""].getCell(e,t)}saveSheetCells(e,t){return this.appConfig.doc.sheetsById[e].saveCells(t)}saveCells(e){return this.appConfig.doc.sheetsById[this.currentSheet||""].saveCells(e)}addSheet(e){return this.appConfig.doc.addSheet(e)}async saveSheetWithJSON(e){const t=this.appConfig.doc.sheetsById[this.currentSheet||""];await this.updateSheet(t,e)}async updateCategorySheet(e){const t=await this.getSheetByTitle("Summary");await t.loadCells();return Object.keys(e).forEach((a=>{const n=e[a],i=Object.keys(n),r=a.replace(/-\d+$/,""),s=Be[r];i.forEach((e=>{const a=Le[e];if("undefined"!==typeof a&&"undefined"!==typeof s){t.getCell(a,s).value=n[e]}}))})),t.saveUpdatedCells()}async udpateMaintenanceSheet(e){const t=await this.getSheetByTitle("Maintanence");await t.loadCells();return Object.keys(e).forEach((a=>{const n=e[a],i=Object.keys(Pe),r=a.replace(/-\d+$/,""),s=_e[r];i.forEach((e=>{const a=Pe[e];if("undefined"!==typeof a&&"undefined"!==typeof s){t.getCell(a,s).value=n[e]}}))})),t.saveUpdatedCells()}async searchUpdateRecord(e,t,a,n){const i=await this.getSheetByTitle(e),r=await i.getRows(),s=r.findIndex((e=>Object.entries(t).every((t=>{let[a,n]=t;return e[a]===n}))));if(-1===s)throw console.log("Record not found."),new Error("RECORD_NOT_FOUND");{const e=r[s];e[a]?console.log("Record found but input column is not empty."):(e[a]=n,await e.save(),console.log("Record updated successfully."))}}isEmptySheet(e){return!e||0===e.rowCount}async updateSheet(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t&&t.length){const n=Object.keys(t[0]),i=n.length,r=a+t.length;for(let s=a;s<r;s+=1){const a=t[s];for(let t=0;t<i;t+=1){const i=e.getCell(s+1,t),r=a[n[t]];i.formattedValue!==r&&(i.value=r)}}}await e.saveUpdatedCells()}async updateSheetWithJSON(e,t){t&&await this.getSheetByTitle(t),await this.appendRows(e)}static getInstance(){return Ue||(Ue=new He,Ue.init()),Ue}}var Fe=He.getInstance();const Ke=()=>({type:H.INIT}),Je=e=>({type:H.INIT_SUCCESS,payload:e}),We=e=>({type:H.INIT_FAILURE,payload:e});let qe=function(e){return e.and="and",e.or="or",e.xor="xor",e.not="not",e.nand="nand",e.nor="nor",e}({});var Ve=class{constructor(e){this.query=void 0,this.query=e}run(e){return Object.keys(this.query).every((t=>{const a=this.query[t];switch(t){case qe.or:return a.some((t=>e(t)));case qe.nor:return!a.some((t=>e(t)));case qe.xor:{const t=a.map((t=>e(t)));return t.some((e=>!0===e))&&t.some((e=>!1===e))}case qe.nand:case qe.not:return!a.every((t=>e(t)));case qe.and:default:return a.every((t=>e(t)))}}))}};const Ge=4,ze={};function Ze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const a=String(e).toLowerCase(),n=[];let i,r=-1;for(;++r<a.length;){const e=a.charAt(r);let t=ze[e];0===r?n.push(e.toUpperCase()):t&&t!==i?n.push(t):t=0===t?void 0:i,i=t}return function(e){const t=Ge-e.length;let a=-1;for(;++a<t;)e+="0";return e}(n.join("")).slice(0,t||Ge)}ze.a=ze.e=ze.i=ze.o=ze.u=ze.y=0,ze.b=ze.f=ze.p=ze.v=1,ze.c=ze.g=ze.j=ze.k=ze.q=ze.s=ze.x=ze.z=2,ze.d=ze.t=3,ze.l=4,ze.m=ze.n=5,ze.r=6;const Xe=(e,t)=>t.split(/\s+/).some((t=>Ze(t.toString())===Ze(e))),$e=(e,t)=>t.some((t=>Ze(t.toString())===Ze(e)));var Qe=class{constructor(e){this.query=void 0,this.query=e}run(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!1;const{opr:n,value:i}=this.query;if(e&&i)switch(n){case"==":a=e.toString()===i.toString()||Xe(i.toString(),e.toString());break;case"!=":a=e.toString()!==i.toString();break;case">":a=e>i;break;case">=":a=e>=i;break;case"<":a=e<i;break;case"<=":a=e<=i;break;case"having":if("string"===typeof e)if(Array.isArray(i))a=i.some((a=>{const n=a.toString(),i=e.toLowerCase(),r=n.toLowerCase();return i.indexOf(r)>-1||!t&&Xe(r,i)}));else{const n=i.toString(),r=e.toLowerCase(),s=n.toLowerCase();a=r.indexOf(s)>-1||!t&&Xe(s,r)}break;case"regex":if(Array.isArray(i))a=i.some((t=>{var a;const n=t.toString(),i=new RegExp(n,"i");return(null===(a=e.match(i))||void 0===a?void 0:a.length)>0}));else{var r;const t=i.toString(),n=new RegExp(t,"i");a=(null===(r=e.match(n))||void 0===r?void 0:r.length)>0}break;case"in":Array.isArray(i)&&(a="string"===typeof i[0]?i.indexOf(e.toString())>-1||$e(e.toString(),i):i.indexOf(e)>-1);break;case"range":Array.isArray(i)&&(a="undefined"===typeof i[0]||e>=i[0],a=a&&("undefined"===typeof i[1]||e<=i[1]))}return a}};class et{constructor(e){this.query=void 0,this.query=e}run(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(this.query).every((a=>{const n=this.query[a];let i=!1;if(Array.isArray(n))i=n.every((n=>{const i=new Qe(n),r=e[a];return i.run(r,t)}));else{i=new Ve(n).run((n=>{const i=new Qe(n),r=e[a];return i.run(r,t)}))}return i}))}}class tt{constructor(e){this.catFieldMap=void 0,this.catFieldMap=e}run(e){const t=Object.keys(this.catFieldMap);e.forEach((e=>{if(!e.Category){const a=t.find((t=>{const a=this.catFieldMap[t];let n;if(Array.isArray(a))n=a.every((t=>new et(t).run(e)));else{n=new Ve(a).run((t=>new et(t).run(e)))}return n}));e.Category=a}}))}}var at={"Maintenance Collection":[{Credit:[{opr:"in",value:["3,200.00","3200","2,700.00","2700","2,800.00","2800","500.00","500","6,400.00","6400","9,600.00","9600","12,800.00","12800","19,000.00","19000"]}],Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}]}],"Audit Fees":[{Description:[{opr:"having",value:["N YASWANTH","YASWANTH","audit","audit fees"]}]}],"Corpus Fund":[{Credit:[{opr:"in",value:["7500","7,500.00","15,000.00","15000","22,500.00","22500","30,000.00","30000","37,500.00","37500","45,000.00","45000"]}],Description:[{opr:"having",value:["corpus","neft","upi","imps"]}]}],"Income Tax Refund":[{Credit:[{opr:"in",value:["ACH","AY20","ACH Credit","AAKAS1985M"]}]}],Bescom:[{Description:[{opr:"having",value:["BESCOM","Electricity","EBANK:BBPS"]}]}],BWSSB:[{Debit:[{opr:"range",value:[14e3,16500]}],Description:[{opr:"having",value:["BANGALORE WATER SUPPLY","BWSSB","BANGALORE ONE","EBANK:BBPS"]}]}],"CCTV / Intercomm":[{Description:[{opr:"having",value:["SHANKAR TELECOM LINKS","Intercom"]}]}],Security:[{Debit:[{opr:"in",value:[35e3,35e3,41e3,41e3]}]}],"House Keeping Salary":[{Description:[{opr:"regex",value:["keeping","housekeeping","house keeping","Housekeeping.+Salary","House keeping.+Salary","house-keeping.+salary","housekeeping.+ladies","hk.+salary","hyrunni","sunanda"]}]}],"Garden Maintenance":[{Description:[{opr:"regex",value:["garden","gardner","Gardner.+Salary","garden.+work","Manure"]}]}],"Garbage Collection Vendor / BBMP":[{Description:[{opr:"having",value:["SYED ALI BASHA","RR CLEANING","RR CLEAN"]}]}],"Borewell And Motor Maintenance":[{Description:[{opr:"having",value:["borewell","motor","coil","winding"]}]}],"Lift Maintenance":[{Description:[{opr:"regex",value:["JOHNSON.+LIFTS","Lift"]}]}],"HK Items Purchased":[{Description:[{opr:"regex",value:["Housekeeping.+Items","Housekeeping.+Material","hk.+item","HK.+Material","bleaching","garbage drum","powder","mop","dust","dustbin","soap","detergent","broom","switch","tubelight","switch","light","bulb","Phenoyl","powder","phenoyl","sanitizer","cleaner","dettol","bottle","neem oil","tap","kerosene"]}]}],"Electrical / Plumbing Repairs":[{Description:[{opr:"having",value:["electric repair","electric work","electric","Chamundi","plumbing"]}]}],"Septic Tank Repairs / Cleaning":[{Description:[{opr:"having",value:["septik","septic","septic tank","sewage","sewage tank","sewage work","sewage pipe"]}]}],"Water Tanks Cleaning":[{Description:[{opr:"regex",value:["water.+tank","cauvery","kaveri"]}]}],"Generator Maintenance and Repair":[{Description:[{opr:"regex",value:["venus.+energy","kirloskar","generator"]}]}],"Savings Bank SMS Charges/Cheque book":[{Description:[{opr:"regex",value:["SMS .+Alert","cheque.+book","charges","chq.+book"]}]}],"Health Club Maintenance":[{Description:[{opr:"having",value:["gym","FITNESS","sports"]}]}],"Festival/Holiday Celebration":[{Description:[{opr:"regex",value:["diwali.+work","diwali","festival","celebration","pooja","pongal","independence","republic","sweets","flag"]}]}],"Drinking Water for Employees":[{Description:[{opr:"having",value:["drinking","drinking water","mineral water","water purchase"]}]}],Diesel:[{Description:[{opr:"regex",value:["Diesel"]}]}],"BAF Subscription Charges":[{Description:[{opr:"regex",value:["BAF","BAF Subscription"]}]}],"Annual Bonus":[{Description:[{opr:"regex",value:["bonus"]}]}],"Interest on account":[{Description:[{opr:"having",value:["89630100005613"]}]}],"FD Deposit":[{Description:[{opr:"having",value:["TO TRANSFER","Repayment Credit"]}]}],"Tenant Deposit from the Owners":[{Credit:[{opr:"in",value:["10,000.00","10000"]}]}],"Apartment Work By Security and Others":[{Description:[{opr:"regex",value:["Apartment.+Work","Cleaning.+Rain Water"]}]}],"Apartment Safety":[{Description:[{opr:"having",value:["sanitization","sanitizing","mask","sheild","shield","spray","cutting tree","fire","extinguisher","rat poison"]}]}],"Apartment developments":[{Description:[{opr:"having",value:["stationery","pen","paper","folder","files","notebook","note book","note-book","entry book","reciept book","bought","purchased","purchase of","cash voucher"]}]}],"Apartment repairs related":[{Description:[{opr:"having",value:["cement work","cement","service","repair","spanner","fixing","fixed"]}]}],"Misc expenses":[{Description:[{opr:"having",value:["tea","coffee"]}]}],"Fine / Extra Payment Received":[{Description:[{opr:"having",value:["maintenance","neft","upi","imps"]}],Credit:[{opr:"regex",value:["\\d"]}]}],"Other Income":[{Description:[{opr:"having",value:["income","other"]}],Credit:[{opr:">",value:0}]}],"Cash Withdrawal / in hand":{or:[{Description:[{opr:"regex",value:["cash","withdrawal","bank","basavaraj","carry.+forwarded","self"]}]},{"Cheque No":[{opr:"regex",value:["\\d+"]}]}]},"Deposit to RD account":[{Description:[{opr:"having",value:["3715125","SI:89630300010611"]}]}]},nt={"001":[{Description:[{opr:"having",value:["khadir","MOHAMEDABDULKHA"]}]}],"002":[{Description:[{opr:"having",value:["jyotiprakash.jpl.99","jyoti prakash","jyotiprakash","shainv","potti","MAHESH"]}]}],"003":[{Description:[{opr:"having",value:["gulshan","padma","6364883334","subhrojyoti","6289470044"]}]}],"004":[{Description:[{opr:"having",value:["ANAND","ESHWARDAS"]}]}],"005":[{Description:[{opr:"having",value:["KOPRESH"]}]}],"007":[{Description:[{opr:"having",value:["007"]}]}],"008":[{Description:[{opr:"having",value:["NITHIN","/008","Repaka"]}]}],"009":[{Description:[{opr:"having",value:["rutvijkanzaria","PRATIK","9120182537"]}]}],"010":[{Description:[{opr:"having",value:["ANANTH","BHASKAR","PAKALAPATI"]}]}],"011":[{Description:[{opr:"having",value:["AKARSH","AKARSHPRAVEENRAJ"]}]}],"012":[{Description:[{opr:"having",value:["K B GANESH","GANESH","VIVEKNAYAK","VIVEK NAYAK"]}]}],101:[{Description:[{opr:"having",value:["VIJAYAKUMAR T","VIJAYAKUMAR"]}]}],102:[{Description:[{opr:"having",value:["ARNAB","CHAKRABORTY","ARNABCHAKRABORT"]}]}],103:[{Description:[{opr:"having",value:["KRISHNA KUMAR","KRISHNAKUMAR"]}]}],104:[{Description:[{opr:"having",value:["AMIT KUMAR","KARMAKAR","AMITKUMAR"]}]}],105:[{Description:[{opr:"having",value:["MURUGAN","VIKASVERMA","VIKAS VERMA","MB105","105MAINTENA","8892757591"]}]}],106:[{Description:[{opr:"having",value:["mr.uttammohanty","uttam"]}]}],107:[{Description:[{opr:"having",value:["POLAKALA","NARAYANA PRASAD"]}]}],108:[{Description:[{opr:"having",value:["EMMANUEL RAJA A","EMMANUEL"]}]}],109:[{Description:[{opr:"having",value:["K S A RAJA RAM KUMAR","RAJARAMKUMAR"]}]}],110:[{Description:[{opr:"having",value:["SONYKUMARI","SONY KUMARI","PAVAN DEVARU","PAVANDEVARU","MOBLTA"]}]}],111:[{Description:[{opr:"having",value:["SENTHILKUMAR","SENTHIL"]}]}],112:[{Description:[{opr:"having",value:["ARINDAM"]}]}],201:[{Description:[{opr:"having",value:["ESWAR KRISHNAN","ESWAR","KARTHIKEYAN","flat201","ARIJIT"]}]}],202:[{Description:[{opr:"having",value:["SRIHARSHA","SRI HARSHA"]}]}],203:[{Description:[{opr:"having",value:["NILOTPALDAS"]}]}],204:[{Description:[{opr:"having",value:["AMLANJYOTI","AMLAN"]}]}],205:[{Description:[{opr:"having",value:["VIKRAMADITYA","IKRAMADITYA"]}]}],206:[{Description:[{opr:"having",value:["PINAKI","vishnupb619"]}]}],207:[{Description:[{opr:"having",value:["tr.1993@axisb","SRINIVAS","prashant.dombale"]}]}],208:[{Description:[{opr:"having",value:["JESUDOSS"]}]}],209:[{Description:[{opr:"having",value:["MULUKUTLA","AJU JAMES","AJUJAMES","T R RAJARAM","TRRAJARAM","CHALAPATHI"]}]}],210:[{Description:[{opr:"having",value:["TARANBIR","IMPSMBRSur"]}]}],211:[{Description:[{opr:"having",value:["9972528008","pranjan"]}]}],212:[{Description:[{opr:"having",value:["SURAJIT"]}]}],301:[{Description:[{opr:"having",value:["PRABUDH"]}]}],302:[{Description:[{opr:"having",value:["BALAJI"]}]}],303:[{Description:[{opr:"having",value:["SURENDRA"]}]}],304:[{Description:[{opr:"having",value:["MEHDI"]}]}],305:[{Description:[{opr:"having",value:["VIVIN"]}]}],306:[{Description:[{opr:"having",value:["ASHIM","DEBAJYOTI","MUTHIAH"]}]}],307:[{Description:[{opr:"having",value:["SAMPREETH","maddyrocks"]}]}],308:[{Description:[{opr:"having",value:["PRAHLAD"]}]}],309:[{Description:[{opr:"having",value:["7406849918","prasad.kiran","kbv018@okhdfcbank"]}]}],310:[{Description:[{opr:"having",value:["PREMA"]}]}],311:[{Description:[{opr:"having",value:["GURUPRASADA","CHOKKADI"]}]}],312:[{Description:[{opr:"having",value:["SHAKTHI","VINAYAK"]}]}],401:[{Description:[{opr:"having",value:["HARISHA"]}]}],402:[{Description:[{opr:"having",value:["cooldharsha","DHARSHA","JITHA","JITHAJAMES","JITHA JAMES"]}]}],403:[{Description:[{opr:"having",value:["8147758124","shaheer"]}]}],404:[{Description:[{opr:"having",value:["NOBROKER","/404Main","MOHAMMED SAIF"]}]}],405:[{Description:[{opr:"having",value:["SANTOSHKUMAR","/405main","SANTHOSH KUMAR","MALLA"]}]}],406:[{Description:[{opr:"having",value:["PRAVEENVIJAY","PRAVEEN VIJAY"]}]}],407:[{Description:[{opr:"having",value:["GALLA","VARADARAJU"]}]}],408:[{Description:[{opr:"having",value:["UDAY KIRAN","UDAY","YAGNAMURTHY"]}]}],409:[{Description:[{opr:"having",value:["PRABU","SUNDARRAJU","Jeevanantham"]}]}],410:[{Description:[{opr:"having",value:["SIVASANKAR","HANUMANTHA","GANGJI","rohinimh19","ROHINI","MALLIKARJUN"]}]}],411:[{Description:[{opr:"having",value:["NATESAN","ADITYA KOLLURI","ADITYAKOLLURI","santumahapatra","santu mahapatra"]}]}],412:[{Description:[{opr:"having",value:["CHIRANJAN","PAVITHRADM","PAVITHRA"]}]}]};class it{constructor(e){this.catFieldMap=void 0,this.catFieldMap=e}run(e){const t=Object.keys(this.catFieldMap);e.forEach((e=>{if(!e.Flat){const a=t.find((t=>{const a=this.catFieldMap[t];let n;if(Array.isArray(a))n=a.every((t=>new et(t).run(e,!0)));else{n=new Ve(a).run((t=>new et(t).run(e,!0)))}return n}));e.Flat=a}}))}}let rt=function(e){return e["Audit Fees"]="Audit Fees",e.BWSSB="BWSSB",e.Diesel="Diesel",e.Bescom="Bescom",e["House Keeping Salary"]="House Keeping Salary",e.Security="Security",e.Gardener="Gardener",e["Garbage Collection Vendor / BBMP"]="Garbage Collection Vendor / BBMP",e["Borewell And Motor Maintenance"]="Borewell And Motor Maintenance",e["Annual Bonus"]="Annual Bonus",e["Lift Maintenance"]="Lift Maintenance",e["HK Items Purchased"]="HK Items Purchased",e["Health Club Maintenance"]="Health Club Maintenance",e["Electrical / Plumbing Repairs"]="Electrical / Plumbing Repairs",e["Apartment repairs related"]="Apartment repairs related",e["Apartment Painting"]="Apartment Painting",e["CCTV / Intercomm"]="CCTV / Intercomm",e["Misc expenses"]="Misc expenses",e["Apartment developments"]="Apartment developments",e["Apartment Work By Security and Others"]="Apartment Work By Security and Others",e["Septic Tank Repairs / Cleaning"]="Septic Tank Repairs / Cleaning",e["Water Tanks Cleaning"]="Water Tanks Cleaning",e["Generator Maintenance and Repair"]="Generator Maintenance and Repair",e["Savings Bank SMS Charges/Cheque book"]="Savings Bank SMS Charges/Cheque book",e["Festival/Holiday Celebration"]="Festival/Holiday Celebration",e["Drinking Water for Employees"]="Drinking Water for Employees",e["BAF Subscription Charges"]="BAF Subscription Charges",e["Maintenance Collection"]="Maintenance Collection",e["Income Tax Refund"]="Income Tax Refund",e["Other Income"]="Other Income",e["Interest on account"]="Interest on account",e["Fine / Extra Payment Received"]="Fine / Extra Payment Received",e["Corpus Fund"]="Corpus Fund",e["Tenant Deposit from the Owners"]="Tenant Deposit from the Owners",e["FD Deposit"]="FD Deposit",e}({});const st=()=>({type:f.LOAD_TRANS}),ot=e=>({type:f.LOAD_CASH_TRANS_SUCCESS,payload:e}),ct=e=>({type:f.LOAD_ONLINE_TRANS_SUCCESS,payload:e}),lt=e=>({type:f.LOAD_CASH_TRANS_FAILURE,payload:e}),dt=e=>({type:f.LOAD_ONLINE_TRANS_FAILURE,payload:e}),pt=e=>({type:f.UPDATE_MONTHLY_SPLIT,payload:e}),ht=e=>({type:f.UPDATE_MONTHLY_MAINT_SPLIT,payload:e});function ut(e,t){return e.filter((e=>{if(e.Category){return e.Category.split(",").some((e=>{const[a]=e.split("(");return t.indexOf(a.trim())>-1}))}return!1}))}function gt(e,t){return a=>{a(st()),e.forEach((e=>{const a=e.Category,n=e.Date;if(a&&n){var i;const r=a.split(","),s=e.Debit&&"0"!==(null===(i=e.Debit)||void 0===i?void 0:i.toString());let o=s?parseFloat(e.Debit.toString().replace(/,/g,"")):parseFloat(e.Credit.toString().replace(/,/g,""));r.forEach((a=>{let i=a;if(a.indexOf("(")>-1){const e=a.split("(");[i]=e,o=parseFloat(e[1].replace(/(\(|\))/g,"").replace(/,/g,""))}!function(e,t,a,n,i,r){const s=a.replace(/\//g,"-"),o=M()(s,"DD-MM-YYYY").format("MMM-YY");e||(e={});e[o]||(e[o]={});i&&(r=-r);r&&"number"===typeof r?e[o][n]?e[o][n]+=r:e[o][n]=r:console.log("cat",n,o,t)}(t,e,n,i.trim(),!!s,o)}))}})),a(pt({...t}))}}var jt=a(878),bt=a(879),Ot=a(880),mt=a(881),vt=a(882),St=a(883);var At=function(){const e=Object(c.c)((e=>e.trans)),t=Object(c.b)();Object(n.useEffect)((()=>{t(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Cash Transactions";return t=>{t(st()),Fe.init().then((()=>{Fe.getSheetByTitleAsJson(e).then((e=>{new tt(at).run(e),new it(nt).run(ut(e,[rt["Maintenance Collection"],rt["Corpus Fund"]])),t(ot(e)),Fe.saveSheetWithJSON(e)})).catch((e=>{t(lt(e.message))}))}))}}())}),[t]);const a=Object(n.useMemo)((()=>e.cashTransData),[e]),i=Object(n.useMemo)((()=>{let e=[];return a&&a.length>=1&&(e=Object.keys(a[0])),e}),[a]);return Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsxs)("div",{className:"cash-trans",children:[e.loading&&Object(ne.jsx)(jt.a,{}),!e.loading&&Object(ne.jsxs)(bt.a,{children:[Object(ne.jsx)(Ot.a,{children:Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:"Sl. No."}),i.map((e=>Object(ne.jsx)(vt.a,{children:e},e)))]})}),Object(ne.jsx)(St.a,{children:!!a&&a.map(((e,t)=>Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:t+1}),i.map((t=>Object(ne.jsx)(vt.a,{children:"Date"!==t?e[t]:M()(e[t],"DD/MM/YYYY").format("DD/MM/YYYY")},`${t}-${e[t]}`)))]},JSON.stringify(e))))})]})]})})};var yt=function(){const e=Object(c.c)((e=>e.trans)),t=Object(c.b)();Object(n.useEffect)((()=>{t(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Online Transactions";return t=>{t(st()),Fe.init().then((()=>{Fe.getSheetByTitleAsJson(e).then((e=>{new tt(at).run(e),new it(nt).run(ut(e,[rt["Maintenance Collection"],rt["Corpus Fund"]])),t(ct(e)),Fe.saveSheetWithJSON(e)})).catch((e=>{t(dt(e.message))}))}))}}("Online Transactions"))}),[t]);const a=e.onlineTransData,i=Object(n.useMemo)((()=>{let e=[];return a&&a.length>1&&(e=Object.keys(a[0])),e}),[a]);return Object(ne.jsx)(ne.Fragment,{children:Object(ne.jsxs)("div",{className:"online-trans",children:[e.loading&&Object(ne.jsx)(jt.a,{}),!e.loading&&Object(ne.jsxs)(bt.a,{children:[Object(ne.jsx)(Ot.a,{children:Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:"Sl. No."}),i.map((e=>Object(ne.jsx)(vt.a,{children:e},e)))]})}),Object(ne.jsx)(St.a,{children:!!a&&a.map(((e,t)=>Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:t+1}),i.map((t=>Object(ne.jsx)(vt.a,{children:"Date"!==t?e[t]:M()(e[t],"DD-MM-YYYY").format("DD/MM/YYYY")},`${t}-${e[t]}`)))]},JSON.stringify(e))))})]})]})})};a(744);var Ct=function(){const[e,t]=Object(n.useState)(),[a,i]=Object(n.useState)("cash"),[r,s]=Object(n.useState)(""),l=Object(c.b)(),d=Object(c.c)((e=>e.sheet)),{initError:p}=d,h=Object(c.c)((e=>e.trans)),{monthlyCatSplit:u,cashTransData:g,onlineTransData:j,monthlyMaintSplit:b}=h;Object(n.useEffect)((()=>{r&&l(function(e){return t=>{t(Ke());const a=R(e);a.res?t(Je({...B()})):t(We(a.error))}}(r))}),[l,r]);const O=Object(n.useCallback)((()=>{g&&j&&(l(gt([...g,...j],{})),i(void 0))}),[g,l,j]),m=Object(n.useCallback)((()=>{if(g&&j){const a=ut([...g,...j],[rt["Maintenance Collection"]]);l((e=a,t={},a=>{a(st()),e.forEach((e=>{const a=e.Flat,n=e.Date,i=e.Category;if(a&&n&&i){const r=M()(n,"DD/MM/YYYY").format("MMM-YY");t||(t={}),t[r]||(t[r]={});let s=parseFloat(e.Credit.toString().replace(/,/g,""));if(i.indexOf("(")>-1){const e=i.match(/Maintenance Collection\s+\((\d+(\.\d+)?)\)/);e&&(s=parseFloat(e[1]))}s&&"number"===typeof s?t[r][a]?t[r][a]+=s:t[r][a]=s:console.log("Flat",a,r,e)}})),a(ht({...t}))})),i(void 0)}var e,t}),[g,l,j]),v=Object(n.useCallback)((()=>{Fe.updateCategorySheet(u).then((()=>{console.log("Saved"),t("Summary Updated")}))}),[u]),S=Object(n.useCallback)((()=>{Fe.udpateMaintenanceSheet(b).then((()=>{console.log("Saved"),t("Maintenence Split Updated")}))}),[b]),[A,y]=Object(n.useState)(0),C=Object(n.useMemo)((()=>["Cash Transactions","Online Transactions","Map Transactions","Categorize Maintenance"]),[]),f=Object(n.useCallback)((e=>!1),[]),x=Object(n.useCallback)((e=>!1),[]),D=Object(n.useCallback)((()=>{switch(A){case 3:i(void 0),y(2);break;case 2:i("online"),y(1);break;case 1:i("cash"),y(0)}}),[A]),T=Object(n.useCallback)((()=>{}),[]),E=Object(n.useCallback)((()=>{switch(A){case 0:i("online"),y(1);break;case 1:i(void 0),y(2),O();break;case 2:i(void 0),y(3),m()}}),[A,m,O]);return Object(ne.jsxs)("div",{children:[!!e&&Object(ne.jsx)(o.a,{severity:"info",children:e}),!!p&&Object(ne.jsx)(o.a,{severity:"error",children:p}),Object(ne.jsxs)("div",{className:"stepper-header",children:[Object(ne.jsx)(Re.a,{className:"steps",activeStep:A,children:C.map(((e,t)=>{const a={},n={};return f(t)&&(n.optional=Object(ne.jsx)(we.a,{variant:"caption",children:"Optional"})),x(t)&&(a.completed=!1),Object(ne.jsx)(ke.a,{...a,children:Object(ne.jsx)(Ye.a,{...n,children:e})},e)}))}),Object(ne.jsxs)("div",{className:"nav",children:[Object(ne.jsx)(ae.a,{disabled:0===A,onClick:D,children:"Back"}),f(A)&&Object(ne.jsx)(ae.a,{variant:"contained",color:"primary",onClick:T,children:"Skip"}),Object(ne.jsx)(ae.a,{variant:"contained",color:"primary",onClick:E,children:A===C.length-1?"Save":"Next"})]})]}),Object(ne.jsxs)("div",{className:"control",children:[2===A&&Object(ne.jsx)(ae.a,{variant:"outlined",disabled:!u,onClick:v,children:"Save Categorized"}),"\xa0\xa0\xa0",3===A&&Object(ne.jsx)(ae.a,{variant:"outlined",disabled:!b,onClick:S,children:"Save Split"})]}),!p&&!!d.sheetConfig.secret&&Object(ne.jsxs)(ne.Fragment,{children:[0===A&&Object(ne.jsx)(At,{}),1===A&&Object(ne.jsx)(yt,{}),2===A&&!!u&&Object(ne.jsx)(Me.a,{style:Me.b,data:u}),3===A&&!!b&&Object(ne.jsx)(Me.a,{style:Me.b,data:b})]})]})};var ft=()=>Object(ne.jsx)(Ct,{}),xt=a(421),Dt=a.n(xt),Tt=a(894),Et=a(433),It=a(889);function Nt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t&&0!==t.length||(t=Object.values(rt));let a="";const n=[],i=[];return e.split(/[\s_]/m).filter((e=>e&&"/"!==e)).forEach((e=>{/^\d{1,2}-\d{1,2}-\d{2,4}$/.test(e)&&n.push(e),/^\d+(\.\d{1,2})?-?$/.test(e)&&i.push(e)})),a||(a=e.replace(n[0],""),a=a.replace(i[0],"").replace(/_/g,""),a=function(e,t){const a=new Map;e.forEach((e=>{let n=0;const i=e.toLowerCase();t.forEach((e=>{i.includes(e.toLowerCase())&&(n+=1)})),a.set(e,n)}));const n=[...Array.from(a)].sort(((e,t)=>t[1]-e[1]));if(n.length>0&&0!==n[0][1])return n[0][0];return""}(t,[a])||a),{date:n[0],amount:parseFloat(i[0])||0,description:a}}var Mt=a(39);class Rt{constructor(){this.chat=void 0,this.inProgress=!1,this.initProm=void 0;const e=B().geminiKey||"",t=new Mt.a(e).getGenerativeModel({model:"gemini-1.0-pro"}),a=[{category:Mt.c.HARM_CATEGORY_HARASSMENT,threshold:Mt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Mt.c.HARM_CATEGORY_HATE_SPEECH,threshold:Mt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Mt.c.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Mt.b.BLOCK_MEDIUM_AND_ABOVE},{category:Mt.c.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Mt.b.BLOCK_MEDIUM_AND_ABOVE}];this.chat=t.startChat({generationConfig:{temperature:.9,topK:0,topP:1,maxOutputTokens:2048},safetySettings:a}),this.initChat("You are a bill/receipt data extractor. You have to extract the date (dd-mm-YYYY), amount (in number format), description (in short) and isChequeIssued (is cheque issued?). Expect the following date formats as input 'dd-mm-YYYY', 'dd-mm-YY', 'dd/mm/YYYY' and 'dd/mm/YY'. Also sometimes date delimter has been miss-interperated as numberical one. Ex. 25/7124 can be interperated as 25/7/24 which is of format, 'dd/mm/YY'. Also expect multiple numbers, provide the largest number as amount. Don't expect amount to be larger than 6 digits. Also expect the whole input in tabular format separated by newlines and tabs. The whole data is a bill information. If it is electricity bill, Description should be 'Electricity bill'. If it is a BWSSB or Water bill, the description should be BWSSB. Don't use text havig word 'Total' as description. If input is a bill of items purchased, find the reason like 'Motor repair'. If not found, say 'Items Purchased' followed by a line item.")}async initChat(e){this.inProgress=!0;const t=`Following is the context for future chat messages.\n${e}`;this.initProm=this.chat.sendMessage(t)}async extractData(e){this.inProgress&&(await this.initProm,this.inProgress=!1);try{const t=await this.chat.sendMessage(`What is the date (dd-mm-YYYY), amount (in number format), description (in short) and isChequeIssued (is cheque issued?)', extracted from the following text (comes after new line) in JSON format?\n${e}`),{response:a}=t,n=a.text().replace(/```/g,"").replace(/JSON/gi,""),i=JSON.parse(n),r=Array.isArray(i)?i[0]:i;return{date:r.date||r.Date,description:r.description||r.Description,amount:r.amount||r.Amount,isChequeIssued:"undefined"!==typeof r.isChequeIssued?r.isChequeIssued:r.IsChequeIssued}}catch(t){console.log(t)}return{amount:0,date:"",description:"",isChequeIssued:!1}}static getInstance(){return Rt.instance||(Rt.instance=new Rt),Rt.instance}}function wt(e){Ae(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").then((t=>{e(t)}))}Rt.instance=void 0;const kt=async(e,t)=>{await async function(e,t,a,n){let i={Date:e,Debit:t,Category:a};try{await Fe.searchUpdateRecord("Online Transactions",i,"Bill",n)}catch(r){i={Debit:t,Category:a},await Fe.searchUpdateRecord("Online Transactions",i,"Bill",n)}}(e.date,e.amount,e.category||"",Lt(t))};const Yt=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Cash Transactions";await Fe.getSheetByTitle(t)||await Fe.addSheet({headerValues:["Date","Description","Item Description/Purpose","Qty","Price","Debit","Credit","Total","Category","Flat","Bill"],title:t});const a=JSON.parse(JSON.stringify(e));return await Fe.updateSheetWithJSON(a,t),!0},Lt=e=>`https://drive.google.com/file/d/${e}/preview`,Bt=(e,t)=>{var a,n,i;const r={Date:null!==(a=e.date)&&void 0!==a?a:"",Description:null!==(n=e.description)&&void 0!==n?n:"",Debit:null!==(i=e.amount)&&void 0!==i?i:0,Credit:0,Category:e.category,Total:0};return t&&(r.Bill=Lt(t)),r},Pt=(e,t)=>{const a=Bt(e);!a.Description&&t&&(a.Description=t);new tt(at).run([a]),e.category=a.Category,!e.description&&e.category&&(e.description=e.category)},_t={};function Ut(e,t){let a={};return new Promise((n=>{if(e&&e.indexOf("_")>-1&&(a=Nt(e)),a.amount&&a.date&&a.description){const e={...a};Pt(e),n(e)}else if(_t[t.id])n(_t[t.id]);else{const e=`https://drive.usercontent.google.com/download?id=${t.id}`;Ht(e).then((async e=>{var i;if(null!==e&&void 0!==e&&null!==(i=e.data)&&void 0!==i&&i.ParsedResults){var r;const a=(null===(r=e.data.ParsedResults[0])||void 0===r?void 0:r.ParsedText)||"",i=await Rt.getInstance().extractData(a),s={...i,isChequeIssued:"boolean"===typeof i.isChequeIssued?i.isChequeIssued:"true"===i.isChequeIssued};Pt(s,a.toLowerCase()),_t[t.id]=s,n(s)}else{const e={...a};Pt(e),n(e)}}))}}))}const Ht=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return new Promise(((a,n)=>{(e=>{const t=new FormData;return t.append("url",e),t.append("language","eng"),t.append("isTable","true"),t.append("OCREngine","5"),t.append("filetype",".Auto"),Object(ue.a)(he.a,{retries:3}),he.a.post(fe,t,{headers:{"Content-Type":"multipart/form-data",apikey:Ce()}}).catch((e=>{console.error(e)}))})(e).then((async n=>{if(t-=1,n||0===t)a(n);else if(!n){const n=await Ht(e,t);a(n)}}))}))};var Ft=a(855),Kt=a(400),Jt=a(893),Wt=a(885),qt=a(886),Vt=a(858),Gt=a(863),zt=a(892),Zt=a(405),Xt=a.n(Zt),$t=a(856),Qt=a(399),ea=a.n(Qt),ta=a(43),aa=a.n(ta);a(745);var na=e=>{let{transaction:t,previewBill:a,expenseCategories:i,callback:r}=e;const[s,o]=Object(n.useState)(!1),[c,l]=Object(n.useState)(t),[d,p]=Object(n.useState)(!1);Object(n.useEffect)((()=>{(async()=>{o(!0);const e=await Ut("",t.bill);l({...t,...e,isCash:!e.isChequeIssued}),o(!1)})()}),[]);const[h,u]=Object(n.useState)({date:"",amount:"",description:"",category:"",transactionType:""}),g=Object(n.useCallback)((e=>{const{name:t,value:a}=e.target||e;l((e=>({...e,[t]:a})))}),[]),j=Object(n.useCallback)((()=>{let e=!1;if(c.amount?h.amount="":(h.amount="Enter a valid amount",e=!0),c.date&&"invalid date"!==c.date.toLowerCase()?h.date="":(h.date="Enter a valid date",e=!0),c.description?h.description="":(h.description="Enter a valid description",e=!0),c.category?h.category="":(h.category="Select a category",e=!0),e)u({...h});else{const e=JSON.parse(JSON.stringify(c));r(e),p(!0)}}),[r,h,c]);return Object(n.useEffect)((()=>{if(!c.date){const e="01-04-2024";l({...c,date:e})}}),[c,c.date]),Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)(mt.a,{className:d?"form-completed bill-row":"bill-row",children:[Object(ne.jsx)(vt.a,{children:Object(ne.jsx)(se.a,{disabled:s,onMouseEnter:e=>a(e,t.bill),children:Object(ne.jsx)(ea.a,{})})}),Object(ne.jsx)(vt.a,{className:h.date?"cell-error":"",children:Object(ne.jsx)(Wt.a,{title:h.date,children:Object(ne.jsx)("div",{className:"date-wrapper",children:Object(ne.jsx)(Kt.a,{dateAdapter:Ft.a,children:Object(ne.jsx)($t.a,{disabled:s,format:"DD-MM-YYYY",closeOnSelect:!0,value:aa()(M()(c.date,"DD-MM-YYYY").format("YYYY-MM-DD")),onChange:e=>g({value:e.format("DD-MM-YYYY"),name:"date"})})})})})}),Object(ne.jsx)(vt.a,{className:h.description?"cell-error":"",children:Object(ne.jsx)(Wt.a,{title:h.description,children:Object(ne.jsx)(qt.a,{name:"description",disabled:s,value:c.description,onChange:g,fullWidth:!0})})}),Object(ne.jsx)(vt.a,{className:h.amount?"cell-error":"",children:Object(ne.jsx)(Wt.a,{title:h.amount,children:Object(ne.jsx)(qt.a,{name:"amount",type:"number",disabled:s,value:c.amount,onChange:g,fullWidth:!0})})}),Object(ne.jsx)(vt.a,{className:h.category?"cell-error":"",children:Object(ne.jsx)(Wt.a,{title:h.category,children:Object(ne.jsx)(Vt.a,{className:"bill-category",fullWidth:!0,disabled:s,name:"category",value:c.category,onChange:g,children:i.map((e=>Object(ne.jsx)(Gt.a,{value:e.key,children:e.label},e.key)))})})}),Object(ne.jsx)(vt.a,{children:Object(ne.jsx)(zt.a,{name:"isCash",disabled:s,checked:!!c.isCash,value:!0,onClick:()=>g({name:"isCash",value:!c.isCash})})}),Object(ne.jsx)(vt.a,{children:Object(ne.jsx)(se.a,{disabled:s||d,"aria-label":"submit",onClick:j,children:Object(ne.jsx)(Xt.a,{})})})]},c.bill.id),s&&Object(ne.jsx)(mt.a,{className:"loader-row",children:Object(ne.jsx)(Jt.a,{color:"success"})})]})};a(749);var ia=e=>{let{transactions:t,expenseCategories:a,handleSubmit:n,handleSplit:r}=e;const[s,o]=i.a.useState(null),[c,l]=i.a.useState(),d=(e,t)=>{l(t),o(e.currentTarget)},p=Boolean(s),h=p?"simple-popover":void 0;return Object(ne.jsxs)(ne.Fragment,{children:[1===t.length&&Object(ne.jsx)(ae.a,{className:"split-all","aria-label":"split",onClick:()=>r(t[0].bill),size:"small",children:"Split the Bill"}),Object(ne.jsxs)(Tt.a,{component:Et.a,children:[Object(ne.jsxs)(bt.a,{size:"small",children:[Object(ne.jsx)(Ot.a,{children:Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:"Bill Preview"}),Object(ne.jsx)(vt.a,{children:"Date"}),Object(ne.jsx)(vt.a,{children:"Description"}),Object(ne.jsx)(vt.a,{children:"Amount"}),Object(ne.jsx)(vt.a,{children:"Category"}),Object(ne.jsx)(vt.a,{children:"Is Cash"}),Object(ne.jsx)(vt.a,{children:"Action"})]})}),Object(ne.jsx)(St.a,{children:t.map((e=>Object(ne.jsx)(na,{previewBill:d,transaction:e,expenseCategories:a,callback:t=>n(t,e.bill.id)},e.bill.id)))})]}),!!c&&Object(ne.jsx)(It.b,{id:h,open:p,anchorEl:s,onClose:()=>{o(null),l(void 0)},anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(ne.jsx)("iframe",{className:"expense-bill-img",src:Lt(c.id),title:"Expense Bill"})})]})]})},ra=a(888),sa=a(871),oa=a(867),ca=a(861),la=a(891),da=a(866);a(750);var pa=e=>{let{callback:t,date:a,amount:i,description:r,category:s,image:o,handleClose:c,expenseCategories:l,mimeType:d,isChequeIssued:p}=e;const[h,u]=Object(n.useState)({date:M()(null!==a&&void 0!==a?a:"01-04-2024","DD-MM-YYYY").format("YYYY-MM-DD"),amount:null!==i&&void 0!==i?i:0,description:null!==r&&void 0!==r?r:"text",category:null!==s&&void 0!==s?s:"",isChequeIssued:p}),[g,j]=Object(n.useState)({date:"",amount:"",description:"",category:"",transactionType:""}),b=Object(n.useCallback)((e=>{const{name:t,value:a}=e.target;u((e=>({...e,[t]:a})))}),[]),O=Object(n.useCallback)((()=>{let e=!1;if(h.amount||(g.amount="Enter a valid amount",e=!0),h.date&&"invalid date"!==h.date.toLowerCase()||(g.date="Enter a valid date",e=!0),h.description||(g.description="Enter a valid description",e=!0),h.category||(g.category="Select a category",e=!0),e)j({...g});else{const e=JSON.parse(JSON.stringify(h));e.date=M()(e.date,"YYYY-MM-DD").format("DD-MM-YYYY"),t(e)}}),[t,g,h]);return Object(ne.jsx)("div",{className:"expense-dialog",children:Object(ne.jsxs)(Z.a,{open:!0,onClose:c,className:"bill-grid-dialog",fullWidth:!0,scroll:"paper",maxWidth:"xl",children:[Object(ne.jsx)(X.a,{children:"Form"}),Object(ne.jsxs)($.a,{children:[d.startsWith("image/")&&Object(ne.jsx)("iframe",{className:"expense-bill-img",src:Lt(o),title:"Expense Bill"}),"application/pdf"===d&&Object(ne.jsx)("embed",{className:"expense-bill-img",src:Lt(o),title:"Expense Bill"}),Object(ne.jsxs)("form",{children:[Object(ne.jsxs)(ra.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.transactionType,children:[Object(ne.jsxs)(sa.a,{"aria-label":"Transaction Type",name:"transactionType",value:h.isChequeIssued?"Online":"Cash",onChange:b,row:!0,children:[Object(ne.jsx)(oa.a,{value:"Cash",control:Object(ne.jsx)(ca.a,{color:"primary"}),label:"Cash"}),Object(ne.jsx)(oa.a,{value:"Online",control:Object(ne.jsx)(ca.a,{color:"primary"}),label:"Online"})]}),!!g.transactionType&&Object(ne.jsx)(la.a,{children:g.transactionType})]}),Object(ne.jsx)(qt.a,{type:"date",name:"date",label:"Date",value:h.date,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",placeholder:"DD-MM-YYYY",error:!!g.date,helperText:g.date}),Object(ne.jsx)(qt.a,{type:"number",name:"amount",label:"Amount",value:h.amount,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.amount,helperText:g.amount}),Object(ne.jsx)(qt.a,{type:"text",name:"description",label:"Description",value:h.description,onChange:b,fullWidth:!0,margin:"normal",variant:"outlined",error:!!g.description,helperText:g.description}),Object(ne.jsxs)(ra.a,{variant:"outlined",fullWidth:!0,margin:"normal",error:!!g.category,children:[Object(ne.jsx)(da.a,{children:"Category"}),Object(ne.jsx)(Vt.a,{name:"category",value:h.category,onChange:b,label:"Category",children:l.map((e=>Object(ne.jsx)(Gt.a,{value:e.key,children:e.label},e.key)))}),!!g.category&&Object(ne.jsx)(la.a,{children:g.category})]})]})]}),Object(ne.jsxs)(te.a,{children:[Object(ne.jsx)(ae.a,{onClick:()=>c(),color:"primary",children:"Cancel"}),Object(ne.jsx)(ae.a,{onClick:O,color:"primary",children:"Submit"})]})]})})},ha=a(869);var ua=e=>{let{folders:t,handleClick:a}=e;const n=t.length?function(e){const t={APR:1,MAY:2,JUN:3,JUL:4,AUG:5,SEP:6,OCT:7,NOV:8,DEC:9,JAN:10,FEB:11,MAR:12};return e.sort(((e,a)=>t[e.name.toUpperCase()]-t[a.name.toUpperCase()])),e}(t):[];return Object(ne.jsx)("div",{children:Object(ne.jsx)(ha.a,{container:!0,spacing:2,children:n.map(((e,t)=>Object(ne.jsxs)(ha.a,{item:!0,xs:2,onClick:()=>a(e.id),children:[Object(ne.jsx)("img",{src:"/images/folder.jpg",id:`folder-${e.name}`,alt:`Folder ${t+1}`,style:{width:200,height:200,cursor:"pointer",padding:"5px"}}),Object(ne.jsx)("h3",{style:{textAlign:"center"},children:e.name})]},`Image ${t+1}`)))})})};class ga{constructor(){this.initProm=void 0,this.sheetIntialized=!1,this.sheets=new Map,this.initProm=Fe.init(),this.initProm.then((()=>{this.sheetIntialized=!0}))}async getSheet(e){return this.sheetIntialized||await this.initProm,new Promise(((t,a)=>{this.sheets.has(e)?t(this.sheets.get(e)):Fe.getSheetByTitle(e).then((n=>{n?(this.sheets.set(e,n),t(n)):a()}))}))}async getExpenseCategories(){return new Promise(((e,t)=>{let a=[];this.getSheet("Summary").then((t=>{const n=Fe.getColumnWithSheet(t,0).map((e=>e.value)),i=[];for(let e=1;e<n.length-1&&"Total Expense"!==n[e];e+=1)i.push(n[e]),a=i.map((e=>({key:e,label:e})));e(a)}))}))}async parseMonthlySheet(e){return(await e.getRows()).map((e=>({Date:M()(e.Date,"DD/MM/YYYY").toDate(),Description:e.Desc,"Cheque No":e.ChqNo,Debit:parseFloat(e.Amount)<0?parseFloat(e.Amount):0,Credit:parseFloat(e.Amount)>=0?parseFloat(e.Amount):0,Total:parseFloat(e.Balance),type:e.Type})))}getMonthData(e){return new Promise(((t,a)=>{this.getSheet(e).then((async e=>{const a=await this.parseMonthlySheet(e);t(a)})).catch((()=>{Fe.addSheet({headerValues:["Date","Desc","ChqNo","Amount","Type","Balance"],title:e}).then((a=>{this.sheets.set(e,a),t([])}))}))}))}pushSheetData(e,t){t.push({Date:M()(e.Date).format("DD-MM-YYYY"),Desc:e.Description,Balance:e.Total,Amount:e.Credit-e.Debit,ChqNo:e["Cheque No"],Type:e.type})}transCompare(e,t){return M()(e.Date).format("DD/MM/YYY")===M()(t.Date).format("DD/MM/YYY")&&e.Description===t.Description&&e.Debit===t.Debit&&e.Credit===t.Credit&&e.type===t.type}async mergeSheetData(e,t){const{transactions:a}=B().appData,n=[];return t.length>0?(a.forEach((e=>{-1===t.findIndex((t=>this.transCompare(t,e)))&&this.pushSheetData(e,n)})),t.forEach((e=>{-1===a.findIndex((t=>this.transCompare(t,e)))&&a.push(e)}))):a.forEach((e=>this.pushSheetData(e,n))),n.length&&await e.addRows(n),!0}async setMonthData(e){const t=await this.getMonthData(e),a=await this.getSheet(e);return await this.mergeSheetData(a,t),!0}}new ga,a(751);var ja=a(229),ba=a(85);async function Oa(e){const t=await async function(e){const{googleAPIKey:t}=B(),a=`https://www.googleapis.com/drive/v3/files/${e}?alt=media&key=${t}`,n=await he.a.get(a,{responseType:"arraybuffer"});return new Uint8Array(n.data)}(e),a=await ja.PDFDocument.load(t),n=a.getPageCount(),i=[];for(let r=0;r<n;r+=1)i.push(ma(a,r));return console.log("All PDF pages have been split and saved locally."),Promise.all(i)}async function ma(e,t){const a=await ja.PDFDocument.create(),[n]=await a.copyPages(e,[t]);a.addPage(n);const i=await a.save(),r=`page_${t+1}.pdf`;ba.writeFileSync(r,i),console.log(`Page ${t+1} saved locally as ${r}`)}function va(){const[e,t]=Object(n.useState)(!1),[a,i]=Object(n.useState)([]),[r,s]=Object(n.useState)(!1),[o,c]=Object(n.useState)(),[l,d]=Object(n.useState)(""),[p,h]=Object(n.useState)({date:"",amount:0,description:"",category:""}),u=Object(n.useCallback)((e=>{d(e)}),[]),g=(Object(n.useCallback)((async e=>{c(e),t(!0);const n=a.find((t=>t.id===e.id)),i=null===n||void 0===n?void 0:n.name,r=await Ut(i,e);t(!1),h(r),s(!0)}),[a]),Object(n.useCallback)((e=>{Oa(e.id).then((()=>console.log("Operation completed successfully."))).catch((e=>console.error("Error:",e)))}),[])),j=Object(n.useCallback)(((e,t)=>{const n=t||(null===o||void 0===o?void 0:o.id);if(n&&null!==e&&void 0!==e&&e.date){const t=a.find((e=>e.id===n));n&&t&&ye(n,t.name).then((()=>{if(wt(i,l),e.isChequeIssued)kt(e,n);else{const t=[Bt(e,n)];Yt(t)}}))}c(void 0),s(!1)}),[a,o,l]);Object(n.useEffect)((()=>{wt(i,l)}),[l]);const[b,O]=Object(n.useState)([]);Object(n.useEffect)((()=>{(async()=>{const e=new ga,t=await e.getExpenseCategories();O(t)})()}),[]);const m=Object(n.useMemo)((()=>a.filter((e=>(e.mimeType.startsWith("image/")||"application/pdf"===e.mimeType)&&!e.name.startsWith(ve)))),[a]),v=Object(n.useMemo)((()=>m.map((e=>({date:"",description:"",amount:0,category:"",isCash:!0,bill:e})))),[m]),S=Object(n.useMemo)((()=>a.filter((e=>"application/vnd.google-apps.folder"===e.mimeType))),[a]);return Object(ne.jsxs)("div",{className:"bill-workspace",children:[!!l&&Object(ne.jsx)(se.a,{onClick:()=>d(""),"aria-label":"Back",children:Object(ne.jsx)(Dt.a,{})}),Object(ne.jsx)("h3",{className:"inline-h3",children:"Unprocessed Bills"}),!l&&Object(ne.jsx)(ua,{folders:S,handleClick:u}),!!l&&Object(ne.jsx)(ia,{handleSubmit:j,transactions:v,expenseCategories:b,handleSplit:g}),!!o&&r&&Object(ne.jsx)(pa,{...p,image:o.id,mimeType:o.mimeType,callback:j,handleClose:j,expenseCategories:b}),e&&Object(ne.jsx)("div",{className:"overlay",children:Object(ne.jsx)(jt.a,{})})]})}var Sa=a(422);a(760);var Aa=e=>{const[t,a]=Object(n.useState)(),i=Object(n.useCallback)((t=>{e.onUpload(t)}),[e]),r=Object(n.useCallback)((e=>{a(e)}),[]);return Object(ne.jsxs)(ne.Fragment,{children:[t&&Object(ne.jsx)(o.a,{severity:"error",children:t}),Object(ne.jsx)("p",{children:"Upload a transaction file (.csv or .xls) to process."}),Object(ne.jsx)("div",{className:"file-upload-wrapper",children:Object(ne.jsx)(Sa.FilePicker,{extensions:["csv","xls","xlsx"],onChange:i,onError:r,children:Object(ne.jsx)("button",{type:"button",children:"Upload"})})})]})},ya=a(230),Ca=a.n(ya);const fa="__EMPTY_",xa="2",Da="5",Ta="9",Ea="12",Ia="17",Na=["21","19","20","22"],Ma="TRAN DATE,",Ra="TRAN DATE",wa="NARRATION",ka="CHQ.NO.",Ya="WITHDRAWAL(DR)",La="DEPOSIT(CR)",Ba="BALANCE(INR)",Pa={parseCsvFile:e=>new Promise((t=>{const a=new FileReader;a.onload=e=>{const a=e.target.result.split(/\r?\n/),n=a.findIndex((e=>e.startsWith(Ma)));if(-1===n)throw new Error(`Header line starting with '${Ma}' not found.`);const i=a[n].split(","),r=[];for(let t=n+1;t<a.length;t+=1){const e=a[t].trim();if(e){const t=e.split(","),a={};i.forEach(((e,n)=>{e&&(a[e]=t[n]||"")})),r.push(a)}}t(Pa.parseCsvTransactions(r))},a.readAsBinaryString(e)})),parseXLS:e=>new Promise((t=>{const a=new FileReader;a.onload=e=>{const a=Ca.a.read(e.target.result,{type:"binary"}),n=a.Sheets[a.SheetNames[0]],i=Ca.a.utils.sheet_to_json(n),r=Pa.parseTransactions(i);t(r)},a.readAsBinaryString(e)})),parseAmount:e=>{let t;return t="string"===typeof e?parseFloat(e.replace("Cr","").replaceAll(",","")):e,t},getWorkingColumnKeyFromArray:(e,t)=>e.find((e=>!!t[`${fa}${e}`])),parseCsvTransactions:e=>{let t=[];if(e.length){const a=Ra,n=e.filter((e=>e[a]&&10===e[a].length&&e[a].includes("/")&&"Invalid Date"!==M()(e[a],"dd/MM/YYYY").toDate().toString())),i=Ba,r=wa,s=ka;t=n.map((e=>{const t={Date:M()(e[a],"DD/MM/YYYY").toDate(),Description:e[r],"Cheque No":e[s]||"",Debit:0,Credit:0,Total:Pa.parseAmount(e[i]),type:"ONLINE"};return e[Ya]&&(t.Debit=Pa.parseAmount(e[Ya])),e[La]&&(t.Credit=Pa.parseAmount(e[La])),t}))}return t},parseTransactions:e=>{let t=[];if(e.length){const a=`${fa}${xa}`,n=e.filter((e=>e[a]&&10===e[a].length&&e[a].includes("/")&&"Invalid Date"!==M()(e[a],"dd/MM/YYYY").toDate().toString()));let i=Pa.getWorkingColumnKeyFromArray(Na,n[0])||"";const r=`${fa}${Da}`,s=`${fa}${Ta}`;i=`${fa}${i}`,t=n.map((e=>{const t={Date:M()(e[a],"DD/MM/YYYY").toDate(),Description:e[r],"Cheque No":e[s]||"",Debit:0,Credit:0,Total:Pa.parseAmount(e[i]),type:"ONLINE"};return e[`${fa}${Ea}`]&&(t.Debit=Pa.parseAmount(e[`${fa}${Ea}`])),e[`${fa}${Ia}`]&&(t.Credit=Pa.parseAmount(e[`${fa}${Ia}`])),t}))}return t}};var _a=Pa;a(764);var Ua=e=>{const{xlsData:t,name:a}=e,i=Object(n.useMemo)((()=>{const e={};return t.forEach((t=>{const a=M()(t.Date).format("MMM-YY");e[a]=a})),e}),[t]),r=Object.values(i),[s,o]=Object(n.useState)(1===r.length?r[0]:""),{appData:c}=Object(n.useContext)(_);c.transSheetMonth=s;Object(n.useCallback)((e=>{e.target.value&&(c.transSheetMonth=e.target.value,o(e.target.value))}),[c]);let l=t;s&&(l=t.filter((e=>M()(e.Date).format("MMM-YY")===s)),c.transactions=l);Object(n.useCallback)((()=>{}),[]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("div",{className:"preview-header",children:Object(ne.jsxs)("div",{children:["File: ",Object(ne.jsx)("h4",{children:a})]})}),Object(ne.jsx)(Tt.a,{className:"xls-file-preview",component:Et.a,children:Object(ne.jsxs)(bt.a,{size:"small",stickyHeader:!0,"aria-label":"Parsed Bank Transactions",children:[Object(ne.jsx)(Ot.a,{children:Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{children:"#"}),Object(ne.jsx)(vt.a,{children:"Date"}),Object(ne.jsx)(vt.a,{children:"Description"}),Object(ne.jsx)(vt.a,{align:"right",children:"Cheque No."}),Object(ne.jsx)(vt.a,{align:"right",children:"Debit"}),Object(ne.jsx)(vt.a,{align:"right",children:"Credit"}),Object(ne.jsx)(vt.a,{align:"right",children:"Total"})]})}),Object(ne.jsx)(St.a,{children:l.map(((e,t)=>Object(ne.jsxs)(mt.a,{children:[Object(ne.jsx)(vt.a,{component:"th",scope:"row",children:t+1}),Object(ne.jsx)(vt.a,{component:"th",scope:"row",children:M()(e.Date).format("DD-MM-YYYY")}),Object(ne.jsx)(vt.a,{children:e.Description}),Object(ne.jsx)(vt.a,{align:"right",children:e["Cheque No"]}),Object(ne.jsx)(vt.a,{align:"right",children:e.Debit}),Object(ne.jsx)(vt.a,{align:"right",children:e.Credit}),Object(ne.jsx)(vt.a,{align:"right",children:e.Total})]},`${e.Date}-${e.Description}`)))})]})})]})};var Ha=function(e){const{data:t}=e,[a,i]=Object(n.useState)("");Object(n.useEffect)((()=>{Fe.init()}),[]);const r=Object(n.useCallback)((async()=>{const e="Online Transactions";await Fe.getSheetByTitle(e)||await Fe.addSheet({headerValues:["Date","Description","Cheque No","Debit","Credit","Total","Category","Flat"],title:e});const a=JSON.parse(JSON.stringify(t)).map((e=>(e.Date=M()(e.Date).format("DD-MM-YYYY"),e)));await Fe.updateSheetWithJSON(a,e),i("Sheet Updated")}),[t]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)("p",{children:a}),Object(ne.jsx)("div",{className:"tools",children:Object(ne.jsx)(ae.a,{variant:"outlined",onClick:r,children:"Save Sheet"})})]})};a(765);var Fa=()=>{const{sheetConfig:e}=Object(c.c)((e=>e.sheet)),[t,a]=Object(n.useState)(""),[i,r]=Object(n.useState)(0),[s,l]=Object(n.useState)(""),[d,p]=Object(n.useState)([]),h=Object(n.useCallback)((t=>{l(t.name);let n=_a.parseXLS;"text/csv"===t.type&&(n=_a.parseCsvFile),n(t).then((t=>{e.appData.transactions=t,t.reverse(),p(t),a(""),r(1)}))}),[e.appData]),u=Object(n.useCallback)((e=>{switch(e){case 0:return Object(ne.jsx)(Aa,{onUpload:h});case 1:return Object(ne.jsx)(Ua,{name:s,xlsData:d});case 2:return Object(ne.jsx)(Ha,{data:d});default:return"Unknown step"}}),[d,h,s]),[g,j]=Object(n.useState)(new Set),b=["File Upload","File Preview","Save"],O=Object(n.useCallback)((e=>g.has(e)),[g]),m=Object(n.useCallback)((async()=>{let e=g;if(O(i)&&(e=new Set(e.values()),e.delete(i)),0===i)s?(r((e=>e+1)),a("")):a("Select a file.");else r((e=>e+1)),a("");j(e)}),[i,s,O,g]),v=Object(n.useCallback)((()=>{r(0)}),[]);return Object(ne.jsxs)("div",{className:"wizard",children:[t&&Object(ne.jsx)(o.a,{severity:"error",children:t}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(Re.a,{activeStep:i,children:b.map(((e,t)=>{const a={},n={};return O(t)&&(a.completed=!1),Object(ne.jsx)(ke.a,{...a,children:Object(ne.jsx)(Ye.a,{...n,children:e})},e)}))}),Object(ne.jsxs)("div",{children:[i===b.length&&Object(ne.jsxs)("div",{children:[Object(ne.jsx)(we.a,{children:"All steps completed - you're finished"}),Object(ne.jsx)(ae.a,{onClick:v,children:"Reset"})]}),i!==b.length&&Object(ne.jsxs)("div",{children:[Object(ne.jsx)(we.a,{children:u(i)}),Object(ne.jsxs)("div",{children:[Object(ne.jsx)(ae.a,{disabled:0===i,onClick:()=>{r((e=>e-1))},children:"Back"}),!1,Object(ne.jsx)(ae.a,{variant:"contained",color:"primary",onClick:m,children:i===b.length-1?"Save":"Next"})]})]})]})]})]})};var Ka=()=>Object(ne.jsx)(Fa,{}),Ja=a(895),Wa=a(896),qa=a(423),Va=a.n(qa);a(766);var Ga=()=>{const[e,t]=Object(n.useState)(""),[a,i]=Object(n.useState)(""),[r,s]=Object(n.useState)(""),[o,c]=Object(n.useState)(""),l=Object(n.useCallback)((e=>{const a=e.target.value;t(a);const n=((e,t)=>I.a.AES.encrypt(e,null!==t&&void 0!==t?t:L.secret).toString())(a);var r,o;i(n),s((r=n,I.a.AES.decrypt(r,null!==o&&void 0!==o?o:L.secret).toString(I.a.enc.Utf8)))}),[]),d=Object(n.useCallback)((()=>{navigator.clipboard.writeText(a),c("Encrypted value copied to clipboard!"),setTimeout((()=>{c("")}),3e3)}),[a]),p=Object(n.useMemo)((()=>{let t=Object(ne.jsx)(ne.Fragment,{children:"Decrypted Value"});return e===r&&(t=Object(ne.jsxs)(ne.Fragment,{children:["Decrypted Value ",Object(ne.jsx)(Va.a,{className:"encrypt-check"})," "]})),t}),[r,e]);return Object(ne.jsxs)(Ja.a,{maxWidth:"sm",children:[Object(ne.jsx)(we.a,{variant:"h4",gutterBottom:!0,children:"Key Encryption"}),Object(ne.jsx)(qt.a,{label:"Enter Key",variant:"outlined",fullWidth:!0,margin:"normal",value:e,onChange:l}),a&&Object(ne.jsxs)(Wa.a,{marginTop:"20px",children:[Object(ne.jsx)(qt.a,{label:"Encrypted Value",variant:"outlined",fullWidth:!0,margin:"normal",value:a,InputProps:{readOnly:!0},onClick:d}),o&&Object(ne.jsx)(we.a,{variant:"body2",color:"primary",children:o})]}),r&&Object(ne.jsx)(Wa.a,{marginTop:"20px",children:Object(ne.jsx)(qt.a,{label:p,variant:"outlined",fullWidth:!0,margin:"normal",value:r,InputProps:{readOnly:!0}})})]})};var za=function(){return Object(ne.jsx)(Ga,{})};var Za=function(){return Object(ne.jsx)(re.c,{children:Object(ne.jsxs)(re.a,{children:[Object(ne.jsx)(re.a,{path:"/",element:Object(ne.jsx)(Ka,{})}),Object(ne.jsx)(re.a,{path:"/cat",element:Object(ne.jsx)(ft,{})}),Object(ne.jsx)(re.a,{path:"/bills",element:Object(ne.jsx)(va,{})}),Object(ne.jsx)(re.a,{path:"/cash",element:Object(ne.jsx)(Ne,{})}),Object(ne.jsx)(re.a,{path:"/gen-key",element:Object(ne.jsx)(za,{})})]})})};a(767);var Xa=function(){const[e,t]=Object(n.useState)(""),[a,i]=Object(n.useState)(""),[r,l]=Object(n.useState)(!!B().secret);Object(n.useEffect)((()=>{if(a){R(a).res?(t(""),l(!0)):(t("Wrong secret. Enter it again."),i(""))}}),[a]);const[p,u]=Object(n.useState)(!1);return Object(ne.jsx)(c.a,{store:z,children:Object(ne.jsxs)(s.a,{children:[Object(ne.jsxs)("header",{className:"app-header",children:[Object(ne.jsx)("img",{src:"/images/ssfa.png",alt:"Suraksha Sunflower Apartment",width:"80px",height:"60px"}),Object(ne.jsx)("span",{children:"Suraksha Sunflower "})]}),Object(ne.jsxs)("div",{className:"app",children:[Object(ne.jsxs)(A.c,{collapsed:p,children:[Object(ne.jsxs)(A.a,{children:[Object(ne.jsx)(A.b,{icon:Object(ne.jsx)(b.a,{}),title:"Parse Online Transactions",children:Object(ne.jsx)(s.b,{to:"/",children:"Parse Online Transactions"})}),Object(ne.jsx)(A.b,{icon:Object(ne.jsx)(g.a,{}),title:"Categorize Transactions",children:Object(ne.jsx)(s.b,{to:"/cat",children:"Categorize Transactions"})}),Object(ne.jsx)(A.b,{icon:Object(ne.jsx)(S.a,{}),title:"Upload Bills",children:Object(ne.jsx)(s.b,{to:"/bills",children:"Process Bills"})}),Object(ne.jsx)(A.b,{icon:Object(ne.jsx)(m.a,{}),title:"Generate Encrypted Keys",children:Object(ne.jsx)(s.b,{to:"/gen-key",children:"Encrypt Keys"})})]}),Object(ne.jsxs)("div",{className:"sb-footer",children:[!p&&Object(ne.jsx)(d.a,{onClick:()=>u(!0)}),p&&Object(ne.jsx)(h.a,{onClick:()=>u(!1)})]})]}),Object(ne.jsxs)("div",{className:"workspace",children:[e&&Object(ne.jsx)(o.a,{severity:"error",children:e}),!r&&Object(ne.jsx)(ie,{errorMsg:e,handleSecret:i}),r&&Object(ne.jsx)(Za,{})]})]})]})})};a(768);const $a=document.getElementById("root");Object(r.createRoot)($a).render(Object(ne.jsx)(i.a.StrictMode,{children:Object(ne.jsx)(Xa,{})}));t.default={}}},[[769,1,2]]]);
//# sourceMappingURL=main.2e8e9c74.chunk.js.map